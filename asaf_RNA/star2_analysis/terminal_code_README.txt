In order to run 02_star_alignment.bash I used the following loop and sequence.txt with the conditions:

while IFS= read -r i; do echo "Submitting job for file: $i"; sbatch --export=FILE="$i" 02_star_alignment.bash; done < sequence.txt

This gave as output all the star's output
Then I filtered all the .tab the ReadsPerGene.out.tab files in order to keep just the gene_ID and the 
unstranded column, using the 03_table_filtering + loop. Here's the loop:

for f in *ReadsPerGene.out.tab; do sbatch --export=TABLE="$f" 03_table_filtering.bash; done

Once I had all the unstranded files (after 03_table_filtering.bash), I put them in the same folder
After this step I wanted to merge the tables by gene_ID column, but I had to sort that column before:

for f in *_unstranded.txt; do     sort -k1,1 "$f" > "${f%.txt}_sorted.txt"; done

Then I merged all the filtered and sorted files:

for f in *_unstranded_sorted.txt; do     if [[ "$f" != "merged.txt" ]]; then         join -a1 -a2 -e 0 -o auto -t $'\t' merged.txt "$f" > tmp && mv tmp merged.txt;     fi; done

Once I had all the unstranded and sorted files I wrote the following in order to have the header of the final table:

echo -e "GeneID\t$(ls *_unstranded_sorted.txt | sed 's/_ReadsPerGene_unstranded_sorted.txt//g' | paste -sd '\t')" > header.txt

Then I put it as name of the columns of my final merged and sorted table:

cat header.txt merged.txt > final_unstranded_counts.tsv

This final table contains the raw counts of the reads. It has to be analysed with DEseq2. In order to do so,
we need another file called "samplesheet.txt" where the columns are:
-1 = SampleName
-2 = FileName
-3 = Condition (in our case, it was called "Time")
-4 = Replicates

Another file for the DEseq2 analysis was created in order to join the gene_name with the gene_ID. Here's the code:

cat /scratch/sgrazian/tmp/marco_data/RNA_seq/reference/gencode_mouse_annotated_genome.gtf | awk -F "\t" 'BEGIN{OFS="\t"}{if($3=="transcript"){split($9, a, "\""); print a[4],a[2],a[8]}}' > tx2gene.gencode.v29.csv

It was generated by the same gtf file used for star index
I called this file "tx2gene.gencode.v29.csv"

It has to be generated everytime you change the .gtf file for the alignment.